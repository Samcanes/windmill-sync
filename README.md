# Windmill CE Multi-Workspace 2-Way Sync GitHub Action

This plugin provides a GitHub Action for 2-way syncing all Windmill CE workspaces with a GitHub repository.

- This repo was autogenerated by GPT-4.1.
- Verify code for your use case before using.
- You can fork the repo and use it to sync with your CE Windmill.
- Create new folders in `/windmill/` for each workspace.

---

## Features

- Syncs all workspaces (not just one)
- Handles full Windmill project structure
- Runs on push to main
- Minimal manual setup
- Auto-commits changes with workspace and timestamp

---

## Setup & Usage

1. **Fork this repo** to your own GitHub account.

2. **Add your Windmill API token**:
   - Go to your fork’s **Settings → Secrets and variables → Actions**.
   - Add a new secret named `WINDMILL_TOKEN` with your Windmill CE API token.

3. **Organize your repo**:
   - Place all Windmill workspace folders under `/windmill/` in your repository root.
   - Each workspace should have its own subfolder, for example:
     ```
     /windmill/
       /workspace-1/
       /workspace-2/
       /wmill.yaml
     ```

4. **(Optional) Configure workspaces**:
   - To explicitly list workspaces, create `/windmill/workspaces.json`:
     ```json
     {
       "workspaces": ["workspace-1", "workspace-2"]
     }
     ```
   - Otherwise, the script will auto-detect subfolders in `/windmill/`.

5. **Enable GitHub Actions**:
   - The workflow file is at `.github/workflows/windmill-multi-sync.yml`.
   - On every push to `main`, the action will:
     - Loop over all workspace folders in `/windmill/`
     - Pull from Windmill (`wmill sync pull`)
     - Commit and push changes to GitHub if any files changed
     - Push local changes back to Windmill (`wmill sync push`)
     - Skip if no changes
     - Only push to GitHub if the commit was made by a human (avoiding infinite loops)

6. **Monitor sync status**:
   - Check the **Actions** tab in your GitHub repository for logs and sync results.

---

## Customization

- Edit `.github/workflows/windmill-multi-sync.yml` to adjust sync logic or error handling.
- The workflow uses the latest Windmill CLI automatically.

---

## File Overview

- `.github/workflows/windmill-multi-sync.yml`: Main GitHub Action workflow for multi-workspace sync.
- `/windmill/`: Place your workspace folders here.
- `/windmill/wmill.yaml`: (Optional) Windmill remotes config.
- `README.md`: This file.

---

## Disclaimer

This repo was autogenerated by GPT-4.1.  
**Verify code for your use case before using in production.**  
Fork and adapt as needed for your Windmill CE instance.
